---
title: "资本资产定价模型 (CAPM)"
---

## 本节课主要内容

1.  **CAPM 模型的理论基础**:  理解 CAPM 模型的核心假设和理论逻辑。
2.  **CAPM 模型的推导过程**:  掌握从投资组合理论到 CAPM 模型的推导过程。
3.  **CAPM 模型的经济学解释**:  理解 Beta 系数的经济含义，以及风险溢价的概念。
4.  **CAPM 模型的实证检验**:  学习 CAPM 模型的常用实证检验方法，并了解在中国市场的检验结果。
5.  **实践：使用 Python 计算个股 Beta 值**:  掌握使用 Python 计算 Beta 值的方法。
6.  **CAPM 模型的局限性**:  认识 CAPM 模型在实际应用中的局限性。

## CAPM 模型的理论基础

### 为什么要学习 CAPM 模型？

-   **现代金融理论的基石**:  CAPM 模型是现代金融理论的起点，理解 CAPM 是学习更高级模型的必要基础。
-   **风险与收益的定价模型**:  CAPM 模型提供了一个简洁的框架，用于理解风险和预期收益之间的关系，是资产定价的核心模型之一。
-   **投资决策的重要工具**:  CAPM 模型可以帮助投资者评估资产的合理收益率，进行投资组合管理和绩效评估。
-   **学术研究和实践应用的广泛性**:  CAPM 模型在学术研究和投资实践中都得到了广泛的应用，是金融领域从业人员必备的知识。

### CAPM 模型的核心假设

CAPM 模型建立在一系列理想化的假设之上，理解这些假设是理解模型适用范围和局限性的关键。

-   **投资者是风险厌恶的，追求效用最大化**:
    -   投资者在给定的收益水平下，偏好风险较低的投资；在给定的风险水平下，偏好收益较高的投资。
    -   投资者进行投资决策的目标是最大化其期望效用，而非仅仅是期望收益。

-   **市场是完美的**:
    -   **无交易成本**:  买卖资产不存在任何交易费用，如佣金、税费等。
    -   **信息对称**:  所有投资者都可以免费、及时地获得所有相关信息。
    -   **完全可分**:  资产可以被无限分割，投资者可以买卖任意数量的资产。
    -   **无卖空限制**:  投资者可以无限制地卖空任何资产。

-   **存在无风险利率，投资者可以无限制地借贷**:
    -   存在一个无风险利率 $R_f$，投资者可以以该利率无限制地借入或贷出资金。
    -   这意味着投资者可以自由地调整投资组合的风险水平。

-   **所有投资者持有相同的投资期限**:
    -   所有投资者的投资期限都是相同的，例如都为一个月、一年等。
    -   这简化了模型分析，使得我们可以关注单期投资决策。

-   **资产收益率服从正态分布**:
    -   所有资产的收益率都服从正态分布。
    -   正态分布的假设使得我们可以用均值和方差来完整描述收益率的分布特征，简化了风险的度量。

### 核心假设的解读

-   **理想化假设 vs. 现实**:  CAPM 模型的假设在现实市场中很难完全成立，例如交易成本是存在的，信息也不是完全对称的。
-   **模型简化与权衡**:  这些假设是对现实的简化，目的是为了构建一个简洁、易于分析的模型。模型的价值在于提供了一个理解资产定价的基本框架，而不是完美地预测现实。
-   **后续模型的拓展**:  后续的资产定价模型，如 Fama-French 三因子模型、行为金融学模型等，都是在放松 CAPM 模型某些假设的基础上发展起来的。

## CAPM 模型的推导过程

### 投资组合理论回顾：均值-方差分析框架

CAPM 模型的推导基础是马科维茨的投资组合理论，我们首先回顾一下均值-方差分析框架。

-   **期望收益率**:
    -   投资组合的期望收益率是组合中各资产期望收益率的加权平均：
        $E(R_p) = \sum_{i=1}^n w_i E(R_i)$
        其中，$w_i$ 是资产 $i$ 在组合中的权重，$E(R_i)$ 是资产 $i$ 的期望收益率。

-   **组合方差**:
    -   组合的方差（衡量风险）不仅取决于各资产的方差，还取决于资产之间的协方差：
        $\sigma_p^2 = \sum_{i=1}^n \sum_{j=1}^n w_i w_j \sigma_{ij}$
        其中，$\sigma_{ij}$ 是资产 $i$ 和资产 $j$ 收益率之间的协方差。

-   **有效前沿**:
    -   在均值-方差框架下，理性投资者会追求**有效前沿**上的投资组合。
    -   **有效前沿**是指在给定风险水平下，能够获得最高期望收益率的投资组合的集合；或者在给定期望收益率水平下，能够实现最低风险的投资组合的集合。

### 引入无风险资产：资本市场线 (CML)

CAPM 模型在投资组合理论的基础上，进一步引入了无风险资产，并假设所有投资者都持有相同的有效前沿。

-   **无风险资产的特性**:
    -   期望收益率：$E(R_f) = R_f$ （无风险利率）
    -   标准差：$\sigma_f = 0$ （无风险）
    -   与任何风险资产的协方差：$\sigma_{if} = 0$

-   **资本市场线 (CML) 的推导**:
    -   当引入无风险资产后，投资者可以将资金投资于无风险资产和**市场组合** $M$ 的线性组合。
    -   **市场组合** $M$ 是所有风险资产的组合，其权重与各资产的总市值成比例。（在 CAPM 模型中，市场组合本身位于有效前沿上）
    -   **资本市场线 (CML)** 描述了有效前沿从原来的曲线变为一条直线：
        $E(R_p) = R_f + \frac{E(R_m) - R_f}{\sigma_m} \sigma_p$
        其中，$E(R_m)$ 和 $\sigma_m$ 分别是市场组合 $M$ 的期望收益率和标准差。

-   **CML 的经济含义**:
    -   CML 表示在有效市场中，投资者可以通过配置无风险资产和市场组合来获得任何风险水平下的最优风险收益组合。
    -   CML 的斜率 $\frac{E(R_m) - R_f}{\sigma_m}$ 被称为**市场风险溢价的风险价格**，表示每单位风险 (标准差) 可以获得的超额收益。

### 证券市场线 (SML) 的推导：CAPM 模型的核心

CML 描述的是有效组合的定价关系，而 **证券市场线 (SML)** 则进一步给出了**单个资产**的期望收益率与风险之间的关系，这就是 CAPM 模型的核心。

-   **系统性风险与非系统性风险**:
    -   **总风险** (Total Risk)：可以用标准差 $\sigma_i$ 来衡量。
    -   **系统性风险** (Systematic Risk)：也称为市场风险、不可分散风险，是指影响所有资产的共同风险因素，如宏观经济因素、政策变化等。
    -   **非系统性风险** (Unsystematic Risk)：也称为特异风险、可分散风险，是指只影响个别资产的风险因素，如公司管理、行业竞争等。

-   **Beta 系数：系统性风险的度量**:
    -   在 CAPM 模型中，**Beta 系数** ($\beta_i$) 被用来衡量资产 $i$ 的系统性风险。
    -   $\beta_i$  定义为资产 $i$ 收益率与市场组合收益率的协方差，除以市场组合收益率的方差：
        $\beta_i = \frac{Cov(R_i, R_m)}{Var(R_m)}$
    -   $\beta_i$  衡量了资产 $i$ 的收益率对市场组合收益率变化的敏感程度。
        -   $\beta_i > 1$:  资产 $i$ 的波动性比市场组合更大，系统性风险较高。
        -   $\beta_i = 1$:  资产 $i$ 的波动性与市场组合同步。
        -   $\beta_i < 1$:  资产 $i$ 的波动性比市场组合更小，系统性风险较低。
        -   $\beta_i < 0$:  资产 $i$ 与市场组合的变动方向相反，可以对冲市场风险。

-   **证券市场线 (SML) 的公式**:
    -   CAPM 模型的核心公式，描述了单个资产的期望收益率与 Beta 系数之间的线性关系：
        $E(R_i) = R_f + \beta_i[E(R_m) - R_f]$
    -   其中：
        -   $E(R_i)$：资产 $i$ 的期望收益率
        -   $R_f$：无风险利率
        -   $\beta_i$：资产 $i$ 的 Beta 系数
        -   $E(R_m)$：市场组合的期望收益率
        -   $[E(R_m) - R_f]$：**市场风险溢价** (Market Risk Premium)，是投资者投资于市场组合相对于无风险资产所要求的超额收益。

-   **SML 的经济含义**:
    -   SML 表明，在 CAPM 模型下，**只有系统性风险才会被定价**，非系统性风险可以通过分散化投资消除，因此投资者不需要为非系统性风险支付风险溢价。
    -   资产的期望收益率只与其系统性风险 ($\beta_i$) 有关，$\beta_i$ 越高，期望收益率越高。
    -   SML 为资产定价提供了一个基准，可以用来评估资产的价值是否被高估或低估。

## Beta 系数的计算与经济学解释

### Beta 系数的计算方法

-   **定义法**:
    -   根据 Beta 系数的定义公式直接计算：
        $\beta_i = \frac{Cov(R_i, R_m)}{Var(R_m)}$
    -   需要计算资产 $i$ 和市场组合 $m$ 的收益率序列，然后计算协方差和方差。

-   **回归方法**:
    -   更常用的方法是通过回归模型估计 Beta 系数。
    -   **市场模型 (Market Model)**：
        $R_{i,t} = \alpha_i + \beta_i R_{m,t} + \epsilon_{i,t}$
        其中，$R_{i,t}$ 和 $R_{m,t}$ 分别是资产 $i$ 和市场组合在 $t$ 期的收益率，$\epsilon_{i,t}$ 是残差项。
        通过对市场模型进行回归，可以得到 $\beta_i$ 的估计值。
    -   **超额收益率形式**:  为了更符合 CAPM 模型的形式，也可以使用超额收益率进行回归：
        $R_{i,t} - R_{f,t} = \alpha_i + \beta_i(R_{m,t} - R_{f,t}) + \epsilon_{i,t}$
        其中，$R_{f,t}$ 是 $t$ 期的无风险利率，$R_{i,t} - R_{f,t}$ 和 $R_{m,t} - R_{f,t}$ 分别是资产 $i$ 和市场组合的超额收益率。
        在这种形式下，回归得到的 $\alpha_i$ 可以被解释为 **Jensen's alpha**，衡量资产的超额收益，如果 CAPM 模型完全成立，$\alpha_i$ 应该为零。

### 3.2 Beta 系数的经济学解释

-   **Beta 值的含义**:
    -   $\beta_i$  反映了资产 $i$ 对市场整体风险的敏感程度，是衡量系统性风险的重要指标。
    -   不同 Beta 值的股票具有不同的风险特征：
        -   **高 Beta 股票** ($\beta_i > 1$)：
            -   收益率波动幅度大于市场平均水平，市场上涨时涨幅更大，市场下跌时跌幅也更大。
            -   风险较高，但也可能带来更高的潜在收益。
            -   例如：科技股、成长股等。
        -   **市场同步股票** ($\beta_i = 1$)：
            -   收益率波动与市场平均水平一致。
            -   风险收益特征与市场组合相似。
            -   例如：指数基金。
        -   **低 Beta 股票** ($\beta_i < 1$)：
            -   收益率波动幅度小于市场平均水平，市场上涨时涨幅较小，市场下跌时跌幅也较小。
            -   风险较低，收益也相对稳定。
            -   例如：公用事业股、消费必需品股等。
        -   **负 Beta 股票** ($\beta_i < 0$)：
            -   收益率与市场变动方向相反，市场上涨时可能下跌，市场下跌时可能上涨。
            -   可以作为投资组合的对冲工具，降低整体风险。
            -   例如：黄金等避险资产（在某些特定时期）。

-   **Beta 与风险溢价**:
    -   CAPM 模型表明，投资者因承担系统性风险而获得风险溢价，Beta 系数越高，要求的风险溢价越高。
    -   风险溢价 $[E(R_m) - R_f]$ 是对所有资产共同的，而 $\beta_i$ 则是个别资产的风险承担量。
    -   投资者可以通过选择不同 Beta 值的资产来调整投资组合的风险和收益水平。

## CAPM 模型的实证检验

### 实证检验方法回顾

CAPM 模型的常用实证检验方法如下：

1.  **时间序列回归 (Time-Series Regression)**
    -   检验股票收益率是否可以被市场组合的超额收益率解释，$\alpha_i$ 是否显著为零。
    -   公式: $R_{i,t} - R_{f,t} = \alpha_i + \beta_i (R_{m,t} - R_{f,t}) + \epsilon_{i,t}$

2.  **横截面回归 (Cross-Sectional Regression)**
    -   检验股票的平均收益率是否与其 Beta 系数线性相关，$\gamma_{0,t}$ 是否为零，$\gamma_{1,t}$ 是否等于市场风险溢价且显著为正。
    -   步骤：
        1.  估计 Beta：时间序列回归估计 $\beta_i$。
        2.  横截面回归：$R_{i,t} = \gamma_{0,t} + \gamma_{1,t} \beta_i + \eta_{i,t}$

3.  **Fama-MacBeth 回归**
    -   改进的横截面回归方法，处理 Beta 估计误差，更稳健。
    -   步骤：
        1.  滚动窗口估计 Beta：估计 $\beta_{i,t}$。
        2.  横截面回归：$R_{i,t} = \gamma_{0,t} + \gamma_{1,t} \beta_{i,t-1} + \eta_{i,t}$
        3.  计算平均风险溢价：$\bar{\gamma}_1 = \frac{1}{T} \sum_{t=1}^T \gamma_{1,t}$
        4.  检验显著性：检验 $\bar{\gamma}_1$ 是否显著异于零。

### 中国市场上的 CAPM 检验

结合参考书籍《因子投资：方法与实践》的内容，我们可以推断 CAPM 模型在中国市场上的检验结果和特点：

-   **市场因子仍然重要**:  即使在中国 A 股市场，市场因子仍然是解释资产收益率的重要因素，CAPM 模型在一定程度上适用。
-   **定价误差可能较大**:  由于中国市场新兴市场特征，有效性相对较低，市场摩擦较多，CAPM 模型可能存在较大的定价误差 ($\alpha_i$ 显著异于零)。
-   **需要考虑其他因子**:  单因子 CAPM 模型可能不足以充分解释中国市场的资产定价现象，需要考虑加入其他风险因子，如规模、价值、盈利等，构建多因子模型。
-   **检验方法选择**:  Fama-MacBeth 回归等更稳健的方法可能更适合中国市场，以处理 Beta 估计的误差和市场噪音。

### 中国市场 CAPM 实证研究的发现

-   **CAPM 在中国市场有一定解释力，但不如成熟市场**:  市场风险是影响中国 A 股收益率的重要因素，但 CAPM 模型的解释力相对有限。
-   **市场异象在中国市场更为显著**:  规模效应、价值效应、动量效应等市场异象在中国市场可能更为显著，CAPM 模型难以解释这些现象。
-   **多因子模型在中国市场更适用**:  为了更准确地描述中国市场的资产定价，需要构建多因子模型，引入更多风险因子。
-   **市场有效性有待提高**:  中国 A 股市场有效性相对较低，市场摩擦和投资者行为偏差可能导致 CAPM 模型定价偏差。

## CAPM 模型的局限性

CAPM 模型虽然是资产定价理论的基石，但在实际应用中存在诸多局限性，理解这些局限性有助于我们更合理地使用模型，并认识到后续模型发展的必要性。

-   **单因子模型的局限**:
    -   **只考虑市场风险**:  CAPM 模型只考虑了市场组合这一个系统性风险因子，而现实市场中可能存在多种风险因子影响资产收益率，例如：
        -   **规模风险**:  小市值公司可能面临更大的经营风险和流动性风险。
        -   **价值风险**:  价值型公司（高账面市值比）可能面临盈利能力下降的风险。
        -   **盈利能力风险**:  盈利能力较弱的公司可能面临经营困境。
    -   **无法解释所有收益率差异**:  实证研究表明，CAPM 模型无法完全解释不同资产之间的收益率差异，存在 **定价误差** ($\alpha_i \neq 0$)。

-   **对市场有效性的过度假设**:
    -   **市场并非完美**:  现实市场存在交易成本、信息不对称、卖空限制等，这些市场摩擦会影响 CAPM 模型的有效性。
    -   **投资者行为偏差**:  CAPM 模型假设投资者是完全理性的，但行为金融学研究表明，投资者存在各种非理性行为偏差，如过度自信、羊群效应等，这些偏差也会导致市场定价偏离 CAPM 模型的预测。

-   **实证检验的挑战**:
    -   **市场组合难以定义**:  CAPM 理论中的市场组合是包含所有资产的组合，但在实际中难以准确定义和获取，通常只能用股票指数（如沪深300、标普500）作为替代，这可能导致检验结果的偏差。
    -   **模型假设难以验证**:  CAPM 模型的许多假设（如投资者同质性、收益率正态分布）难以直接验证，模型的有效性检验只能是间接的。
    -   **数据和方法的影响**:  实证检验结果可能受到数据频率、时间窗口、检验方法等因素的影响，不同的研究可能得出不同的结论。

-   **无法解释市场异象**:
    -   **市场异象 (Anomalies)**：指 CAPM 模型无法解释的、持续存在的超额收益现象。
    -   常见的市场异象包括：
        -   **规模效应 (Size Effect)**：小市值股票的平均收益率显著高于 CAPM 模型预测的水平。
        -   **价值效应 (Value Effect)**：价值型股票（高账面市值比）的平均收益率显著高于 CAPM 模型预测的水平。
        -   **动量效应 (Momentum Effect)**：过去一段时间收益率较高的股票，未来一段时间的收益率也倾向于较高。
    -   市场异象的存在表明 CAPM 模型对现实市场的描述是不完善的，需要引入更多的风险因子或考虑行为金融学因素来解释这些现象。

## 总结

-   CAPM 模型是资产定价理论的重要基石，为资产定价提供了一个基准框架。
-   CAPM 模型假设投资者是理性的，市场是有效的，资产价格充分反映了所有可获得的信息。
-   CAPM 模型在实际应用中存在诸多局限性，理解这些局限性有助于我们更合理地使用模型，并认识到后续模型发展的必要性。

